<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>7. 무료 도메인 발급 및 SSL 인증서 발급받기 | goodSaem</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="alternate" type="application/rss+xml" href="https://goodsaem.github.io/rss.xml" title="goodSaem RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://goodsaem.github.io/feed.atom" title="goodSaem Atom Feed">
    <link rel="alternate" type="application/json" href="https://goodsaem.github.io/feed.json" title="goodSaem JSON Feed">
    <meta name="description" content="7. 무료 도메인 발급 및 SSL 인증서 발급받기">
    <meta name="google-site-verification" content="TgI6W9yu3WmEvVxC8vfAGVxwUfd4J1RgQa_BoB8ZZvU">
    
    <link rel="preload" href="/assets/css/0.styles.1505a274.css" as="style"><link rel="preload" href="/assets/js/app.3ab2aa80.js" as="script"><link rel="preload" href="/assets/js/2.3b0ca9c5.js" as="script"><link rel="preload" href="/assets/js/12.31171b4c.js" as="script"><link rel="prefetch" href="/assets/js/10.5a7aa700.js"><link rel="prefetch" href="/assets/js/11.ac1467e0.js"><link rel="prefetch" href="/assets/js/13.a4bfa12e.js"><link rel="prefetch" href="/assets/js/14.08b403aa.js"><link rel="prefetch" href="/assets/js/15.b8ea30cf.js"><link rel="prefetch" href="/assets/js/16.672bde12.js"><link rel="prefetch" href="/assets/js/17.cc74a504.js"><link rel="prefetch" href="/assets/js/18.5aaa7aa7.js"><link rel="prefetch" href="/assets/js/19.b3670f0c.js"><link rel="prefetch" href="/assets/js/20.b75b2699.js"><link rel="prefetch" href="/assets/js/21.55825fca.js"><link rel="prefetch" href="/assets/js/22.9315b4f6.js"><link rel="prefetch" href="/assets/js/23.b911abc0.js"><link rel="prefetch" href="/assets/js/24.8cc99d70.js"><link rel="prefetch" href="/assets/js/25.acbba5f5.js"><link rel="prefetch" href="/assets/js/26.020b6b2d.js"><link rel="prefetch" href="/assets/js/27.69fe22c6.js"><link rel="prefetch" href="/assets/js/28.04c80df3.js"><link rel="prefetch" href="/assets/js/29.5558c36b.js"><link rel="prefetch" href="/assets/js/3.58df886c.js"><link rel="prefetch" href="/assets/js/30.906aa227.js"><link rel="prefetch" href="/assets/js/31.74cadd51.js"><link rel="prefetch" href="/assets/js/32.8864675f.js"><link rel="prefetch" href="/assets/js/33.f5124e81.js"><link rel="prefetch" href="/assets/js/34.0187a830.js"><link rel="prefetch" href="/assets/js/35.a7d21445.js"><link rel="prefetch" href="/assets/js/36.bca5a58f.js"><link rel="prefetch" href="/assets/js/37.920ae66d.js"><link rel="prefetch" href="/assets/js/38.a504eecc.js"><link rel="prefetch" href="/assets/js/39.ddde0957.js"><link rel="prefetch" href="/assets/js/4.406747a8.js"><link rel="prefetch" href="/assets/js/40.c2a93784.js"><link rel="prefetch" href="/assets/js/41.c99d6e29.js"><link rel="prefetch" href="/assets/js/42.9785cf48.js"><link rel="prefetch" href="/assets/js/43.f68368f9.js"><link rel="prefetch" href="/assets/js/44.78cdc341.js"><link rel="prefetch" href="/assets/js/45.ead106e0.js"><link rel="prefetch" href="/assets/js/46.2a0a8d87.js"><link rel="prefetch" href="/assets/js/47.734b5447.js"><link rel="prefetch" href="/assets/js/48.3501f2db.js"><link rel="prefetch" href="/assets/js/49.505e8902.js"><link rel="prefetch" href="/assets/js/5.1ff78e6a.js"><link rel="prefetch" href="/assets/js/50.2b1b9999.js"><link rel="prefetch" href="/assets/js/51.5a770c3c.js"><link rel="prefetch" href="/assets/js/52.e17bf888.js"><link rel="prefetch" href="/assets/js/53.bcf9e7be.js"><link rel="prefetch" href="/assets/js/54.d377fcf4.js"><link rel="prefetch" href="/assets/js/55.1a59aeaf.js"><link rel="prefetch" href="/assets/js/56.f9361063.js"><link rel="prefetch" href="/assets/js/57.4fbb2b87.js"><link rel="prefetch" href="/assets/js/58.0c88023e.js"><link rel="prefetch" href="/assets/js/59.6d8a9e1d.js"><link rel="prefetch" href="/assets/js/6.9a8c982d.js"><link rel="prefetch" href="/assets/js/60.a583c6e5.js"><link rel="prefetch" href="/assets/js/61.140ff023.js"><link rel="prefetch" href="/assets/js/62.7b27f68b.js"><link rel="prefetch" href="/assets/js/63.de3ff555.js"><link rel="prefetch" href="/assets/js/64.db962424.js"><link rel="prefetch" href="/assets/js/65.a8540570.js"><link rel="prefetch" href="/assets/js/66.6070ab55.js"><link rel="prefetch" href="/assets/js/67.6ba02bab.js"><link rel="prefetch" href="/assets/js/68.d391818e.js"><link rel="prefetch" href="/assets/js/69.ac3a0025.js"><link rel="prefetch" href="/assets/js/7.e94d68a7.js"><link rel="prefetch" href="/assets/js/70.b4636972.js"><link rel="prefetch" href="/assets/js/71.6dbdfc5c.js"><link rel="prefetch" href="/assets/js/72.a041d08e.js"><link rel="prefetch" href="/assets/js/73.78e1fe0f.js"><link rel="prefetch" href="/assets/js/74.e96912e5.js"><link rel="prefetch" href="/assets/js/75.4a66b075.js"><link rel="prefetch" href="/assets/js/76.dd12a751.js"><link rel="prefetch" href="/assets/js/77.591b7357.js"><link rel="prefetch" href="/assets/js/78.6bde0969.js"><link rel="prefetch" href="/assets/js/79.0db9cc83.js"><link rel="prefetch" href="/assets/js/8.fd0fef98.js"><link rel="prefetch" href="/assets/js/80.9d4085f8.js"><link rel="prefetch" href="/assets/js/81.c8b9671f.js"><link rel="prefetch" href="/assets/js/82.77f1e2b7.js"><link rel="prefetch" href="/assets/js/83.bcd322e3.js"><link rel="prefetch" href="/assets/js/84.0e929037.js"><link rel="prefetch" href="/assets/js/85.00f30d3c.js"><link rel="prefetch" href="/assets/js/86.fc3e537a.js"><link rel="prefetch" href="/assets/js/87.442df45f.js"><link rel="prefetch" href="/assets/js/88.98595988.js"><link rel="prefetch" href="/assets/js/89.dbc8eb5b.js"><link rel="prefetch" href="/assets/js/9.e66e8bbc.js"><link rel="prefetch" href="/assets/js/90.28552c33.js"><link rel="prefetch" href="/assets/js/91.86bbe02f.js"><link rel="prefetch" href="/assets/js/92.835e4ca2.js"><link rel="prefetch" href="/assets/js/93.b9d932a1.js"><link rel="prefetch" href="/assets/js/94.5e3c872e.js"><link rel="prefetch" href="/assets/js/95.241c1216.js"><link rel="prefetch" href="/assets/js/96.d461756d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1505a274.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><main class="page"> <div class="theme-default-content content__default"><h1 id="_7-무료-도메인-발급-및-ssl-인증서-발급받기"><a href="#_7-무료-도메인-발급-및-ssl-인증서-발급받기" class="header-anchor">#</a> <i class="fas fa-server"></i> 7. 무료 도메인 발급 및 SSL 인증서 발급받기</h1> <p>요즘 대부분의 웹서버는 https 통신을 합니다. 이제는 선택이 아닌 필수 인것 같네요 제가 서버를 구축하게 된 직접적인 원인도 https
설정을 하기 위함입니다. nginx 에 https 서비스를 구성하기 위해서는 도메인이 필요합니다. 도메인이 준비되면 certbot을 통해서
무료 ssl 인증서 적용 및 http/2 적용이 가능한데요 무료 도메인 가입부터 nginx 에 셋팅하는 부분까지 진행해 보겠습니다.</p> <h2 id="_1-무료-도메인-발급-받기"><a href="#_1-무료-도메인-발급-받기" class="header-anchor">#</a> 1.무료 도메인 발급 받기</h2> <p><a href="https://www.freenom.com/en/index.html?lang=en" target="_blank" rel="noopener noreferrer">https://www.freenom.com/en/index.html?lang=en<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> freenom 이란
사이트에서 무료 도메인을 발급 받을수 있습니다. 회원가입을 후 도메인 등록을 진행합니다.</p> <ul><li><p>로그인 후 원하는 도메인을 입력하고 엔터키를 클릭한후 사용하고자 하는 도메인에서 Get it now! 버튼을 클릭하여 선택합니다.
그리고 나서 <strong>Checkout</strong> 버튼을 클릭합니다.</p> <p><img src="/assets/img/35.3c18ee3e.jpg" alt="img"></p></li> <li><p>Use DNS 버튼을 클릭하고 Use Freenom DNS Service를 선택한후 aws free tier의 퍼블릭 ipv4 주소를 입력하고 Continue 버튼을 클릭합니다.</p> <p><img src="/assets/img/36.d9bf7487.jpg" alt="img"></p></li> <li><p>도메인 주문이 완료되었습니다.</p> <p><img src="/assets/img/38.247975f7.jpg" alt="img"></p></li> <li><p>My Domain 에서 주문한 도메인 확인이 가능합니다.</p> <div class="custom-block tip"><p class="custom-block-title">goodsaem.ml</p> <p>무료 도메인을 2개 신청했는데 2번째꺼는 어떤이유인지 mydomain에 추가 되지 않아 goodsaem.ml로 셋팅 진행하겠습니다.</p></div> <p><img src="/assets/img/39.e452f436.jpg" alt="img"></p></li></ul> <h2 id="_2-diffie-hellman-키-생성"><a href="#_2-diffie-hellman-키-생성" class="header-anchor">#</a> 2. Diffie-Hellman 키 생성</h2> <p>https 인증서를 받기 위해서는 키가 필요합니다. 이 키 생성은 디피와 헬만이 1976년도에 발표한 비밀키 교환 방식의 알고리즘을
이용하여 생성합니다.이 알고리즘을 이용하여 4096 bit의 키를 생성하겠습니다. 아래 명령어로 키를 생성하는데 대략 10분정도 소요 되었습니다.
이키를 이용해서 https에서 비밀키를 교환하여 안정한 https 통신을 할수 있으므로 반드시 진행해야 되는 사항입니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> openssl dhparam -out /etc/nginx/conf.d/ssl-dhparams.pem <span class="token number">4096</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>enerating DH parameters, <span class="token number">4096</span> bit long safe prime, generator <span class="token number">2</span>
This is going to take a long <span class="token function">time</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_3-let-s-encrypt-와-certbot-을-이용한-무료-인증서-발급"><a href="#_3-let-s-encrypt-와-certbot-을-이용한-무료-인증서-발급" class="header-anchor">#</a> 3. Let's Encrypt 와 Certbot 을 이용한 무료 인증서 발급</h2> <p>Let's Encrypt 는 사용자에게 무료로 SSL/TLS 인증서를 발급해 주는 기관 입니다. 한번 발급 받으면 90일간 사용이 가능하며
만료 30일전에 메일로 내용을 통보하면 그때 다시 갱신이 가능합니다. 인증서 발급은 certbot certbot-auto 를 이용하여
발급 및 갱신합니다.</p> <p>certbot 등록을 위해 repository 등록을 진행합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> software-properties-common
goodsaem@goodsaem:~$ <span class="token function">sudo</span> add-apt-repository universe
goodsaem@goodsaem:~$ <span class="token function">sudo</span> add-apt-repository ppa:certbot/certbot
goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>certbot을 설치합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> certbot
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>certbot nginx 플러그인을 설치 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python-certbot-nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>nginx에 서버 이름을 변경하기 위해 아래와 같이 입력합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">vi</span> /etc/nginx/conf.d/default.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>서버 네임을 freenom에서 발급받은 도메인으로 지정해 줍니다.</p> <div class="language-sh line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-sh"><code>server <span class="token punctuation">{</span>
    listen       <span class="token number">80</span><span class="token punctuation">;</span>
    server_name  goodsaem.ml<span class="token punctuation">;</span>
    charset utf-8<span class="token punctuation">;</span>
    access_log  /var/log/nginx/localhost.access.log  main<span class="token punctuation">;</span>
    error_log /var/log/nginx/localhost.error.log<span class="token punctuation">;</span>
    root /usr/share/nginx/html<span class="token punctuation">;</span>

    location / <span class="token punctuation">{</span>
        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.php?<span class="token variable">$args</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    error_page <span class="token number">405</span> <span class="token operator">=</span><span class="token number">200</span> <span class="token variable">$uri</span><span class="token punctuation">;</span>
    error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>
    location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
        root   /usr/share/nginx/html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location ~ <span class="token punctuation">\</span>.php$ <span class="token punctuation">{</span>
        proxy_pass   http://127.0.0.1<span class="token punctuation">;</span>
        fastcgi_param SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span><span class="token punctuation">;</span>
        include fastcgi_params<span class="token punctuation">;</span>

        fastcgi_pass <span class="token number">127.0</span>.0.1:9000<span class="token punctuation">;</span>
        proxy_redirect off<span class="token punctuation">;</span>
        fastcgi_intercept_errors on<span class="token punctuation">;</span>
        fastcgi_read_timeout <span class="token number">300</span><span class="token punctuation">;</span>
        fastcgi_send_timeout <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location ~ /<span class="token punctuation">\</span>.ht <span class="token punctuation">{</span>
        deny  all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location <span class="token operator">=</span> /xmlrpc.php <span class="token punctuation">{</span>
        deny all<span class="token punctuation">;</span>
        error_page <span class="token number">403</span> <span class="token operator">=</span> /403.html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>이제 아래 certbot 명령어를 통해서 ssl 인증서를 발급받습니다. 인증서 발급시
사용할 admin email 주소와 이용약관 동의 옵션을 지정하여 인증서 발급을 받겠습니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> certbot --nginx --email goodsaem@protonmail.com --agree-tos
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>위에 명령어를 입력하면 아래와 같은 형태로 진행되는데요 중요한 부분만 설명하겠습니다.</p> <ul><li><em><strong>6</strong></em> 라인에 추가할 https 도메인이 보입니다.</li> <li><em><strong>9</strong></em> 라인에서 엔터를 입력합니다.</li> <li><em><strong>24</strong></em> 라인에서 2을 입력합니다. (http로 요청이 들어오면 https 로 redirect 하겠다는 의미 입니다.)</li></ul> <div class="language-sh line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-sh"><code>Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator nginx, Installer nginx

Which names would you like to activate HTTPS for?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
<span class="token number">1</span>: goodsaem.ml
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate numbers separated by commas and/or spaces, or leave input
blank to <span class="token keyword">select</span> all options shown <span class="token punctuation">(</span>Enter <span class="token string">'c'</span> to cancel<span class="token punctuation">)</span>:
Obtaining a new certificate
Performing the following challenges:
http-01 challenge <span class="token keyword">for</span> goodsaem.ml
Waiting <span class="token keyword">for</span> verification<span class="token punctuation">..</span>.
Cleaning up challenges
Deploying Certificate to VirtualHost /etc/nginx/conf.d/default.conf

Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
<span class="token number">1</span>: No redirect - Make no further changes to the webserver configuration.
<span class="token number">2</span>: Redirect - Make all requests redirect to secure HTTPS access. Choose this <span class="token keyword">for</span>
new sites, or <span class="token keyword">if</span> you<span class="token string">'re confident your site works on HTTPS. You can undo this
change by editing your web server'</span>s configuration.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate number <span class="token punctuation">[</span><span class="token number">1</span>-2<span class="token punctuation">]</span> <span class="token keyword">then</span> <span class="token punctuation">[</span>enter<span class="token punctuation">]</span> <span class="token punctuation">(</span>press <span class="token string">'c'</span> to cancel<span class="token punctuation">)</span>: <span class="token number">1</span>

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Congratulations<span class="token operator">!</span> You have successfully enabled https://goodsaem.ml

You should <span class="token builtin class-name">test</span> your configuration at:
https://www.ssllabs.com/ssltest/analyze.html?d<span class="token operator">=</span>goodsaem.ml
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

IMPORTANT NOTES:
 - Congratulations<span class="token operator">!</span> Your certificate and chain have been saved at:
   /etc/letsencrypt/live/goodsaem.ml/fullchain.pem
   Your key <span class="token function">file</span> has been saved at:
   /etc/letsencrypt/live/goodsaem.ml/privkey.pem
   Your cert will expire on <span class="token number">2021</span>-06-23. To obtain a new or tweaked
   version of this certificate <span class="token keyword">in</span> the future, simply run certbot again
   with the <span class="token string">&quot;certonly&quot;</span> option. To non-interactively renew *all* of
   your certificates, run <span class="token string">&quot;certbot renew&quot;</span>
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>제되로 인증서 발급이 되었는지 확인해 보겠습니다.
domain에 보시면 goodsaem.ml 도메인이 등록되어 있습니다. 또한 8,9 라인에
fullchain.pem 키와 privkey.pem 파일이 정상 생성되었음을 확인할수 있습니다.</p> <div class="language-sh line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-sh"><code>Saving debug log to /var/log/letsencrypt/letsencrypt.log

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Found the following certs:
  Certificate Name: goodsaem.ml
    Domains: goodsaem.ml
    Expiry Date: <span class="token number">2021</span>-06-23 <span class="token number">13</span>:15:17+00:00 <span class="token punctuation">(</span>VALID: <span class="token number">89</span> days<span class="token punctuation">)</span>
    Certificate Path: /etc/letsencrypt/live/goodsaem.ml/fullchain.pem
    Private Key Path: /etc/letsencrypt/live/goodsaem.ml/privkey.pem
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>nginx에 ssl 관련 설정이 등록되었는지 default.conf 내용을 확인해 보겠습니다.
40번라인부터 57번 라인까지 ssl 관련 설정이 자동으로 추가되었습니다.</p> <div class="language-sh line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-sh"><code>server <span class="token punctuation">{</span>
    server_name  goodsaem.ml<span class="token punctuation">;</span>
    charset utf-8<span class="token punctuation">;</span>
    access_log  /var/log/nginx/localhost.access.log  main<span class="token punctuation">;</span>
    error_log /var/log/nginx/localhost.error.log<span class="token punctuation">;</span>
    root /usr/share/nginx/html<span class="token punctuation">;</span>

    location / <span class="token punctuation">{</span>
        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.php?<span class="token variable">$args</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    error_page <span class="token number">405</span> <span class="token operator">=</span><span class="token number">200</span> <span class="token variable">$uri</span><span class="token punctuation">;</span>
    error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>
    location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
        root   /usr/share/nginx/html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location ~ <span class="token punctuation">\</span>.php$ <span class="token punctuation">{</span>
        proxy_pass   http://127.0.0.1<span class="token punctuation">;</span>
        fastcgi_param SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span><span class="token punctuation">;</span>
        include fastcgi_params<span class="token punctuation">;</span>

        fastcgi_pass <span class="token number">127.0</span>.0.1:9000<span class="token punctuation">;</span>
        proxy_redirect off<span class="token punctuation">;</span>
        fastcgi_intercept_errors on<span class="token punctuation">;</span>
        fastcgi_read_timeout <span class="token number">300</span><span class="token punctuation">;</span>
        fastcgi_send_timeout <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location ~ /<span class="token punctuation">\</span>.ht <span class="token punctuation">{</span>
        deny  all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    location <span class="token operator">=</span> /xmlrpc.php <span class="token punctuation">{</span>
        deny all<span class="token punctuation">;</span>
        error_page <span class="token number">403</span> <span class="token operator">=</span> /403.html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    listen <span class="token number">443</span> ssl<span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>
    ssl_certificate /etc/letsencrypt/live/goodsaem.ml/fullchain.pem<span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>
    ssl_certificate_key /etc/letsencrypt/live/goodsaem.ml/privkey.pem<span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>
    include /etc/letsencrypt/options-ssl-nginx.conf<span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem<span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>


<span class="token punctuation">}</span>

server <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$host</span> <span class="token operator">=</span> goodsaem.ml<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">return</span> <span class="token number">301</span> https://<span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment"># managed by Certbot</span>


    listen       <span class="token number">80</span><span class="token punctuation">;</span>
    server_name  goodsaem.ml<span class="token punctuation">;</span>
    <span class="token builtin class-name">return</span> <span class="token number">404</span><span class="token punctuation">;</span> <span class="token comment"># managed by Certbot</span>


<span class="token punctuation">}</span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>letsencrypt 에 있는 Diffie-Hellman Key 를 아래와 같은 이름으로 백업합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token builtin class-name">cd</span> /etc/letsencrypt/
goodsaem@goodsaem:~$  <span class="token function">sudo</span> <span class="token function">mv</span> ssl-dhparams.pem  ssl-dhparams.pem.backup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>생성한 키 파일을 /etc/letsencrypt 로 복사합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$  <span class="token function">sudo</span> <span class="token function">cp</span> -rp /etc/nginx/conf.d/ssl-dhparams.pem /etc/letsencrypt/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>nginx 를 재시작 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>goodsaem@goodsaem:~$ <span class="token function">sudo</span> systemctl restart nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_4-ssl-점검"><a href="#_4-ssl-점검" class="header-anchor">#</a> 4. SSL 점검</h2> <p>SSL이 제되로 생성되었는지 <a href="https://www.ssllabs.com/ssltest/analyze.html" target="_blank" rel="noopener noreferrer">https://www.ssllabs.com/ssltest/analyze.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 사이트에 접속하여
아래와 같이 도메인을 입력하고 점검을 수행합니다.</p> <p><img src="/assets/img/40.b31c4d8d.jpg" alt="img"></p> <p>A 라고 연두색으로 나오는것 보니 제되로 설정이 된것 같습니다.
<img src="/assets/img/41.3c95dfc2.jpg" alt="img"></p> <p>이제 실제로 https 로 접속을 시도해 보겠습니다. <a href="https://goodsaem.ml/info.php" target="_blank" rel="noopener noreferrer">https://goodsaem.ml/info.php<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> https 프로토콜을 이용하여
설정한 도메인으로 접속하니 아래 그림과 같이 정상적으로 화면이 나왔습니다. 보안 오류 같은거 없이 ^^ 대 성공입니다. 자물쇠 모양을 더블클릭하세요</p> <p><img src="/assets/img/42.42bc327d.jpg" alt="img"></p> <p>아래와 같이 보안 연결이 사용되었다는 내용이 확인되며 인증서도 유효 하다고 하네요.</p> <p><img src="/assets/img/43.bcce8270.jpg" alt="img"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">마지막 수정일:</span> <span class="time">3/29/2021, 11:57:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/local/106-Nginx-상세설정.html" class="prev">6. Nginx 상세 설정</a></span> <span class="next"><a href="/local/108-ssl-테스트.html">8. ssl 테스트</a>
      →
    </span></p></div>  <div><div id="comment" class="comment"></div></div></main> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><figure><img src="https://avatars.githubusercontent.com/u/72680592?s=400&amp;u=745704d80b906fded3d9399a38120d35e6944318&amp;v=4" alt="goodSaem"></figure> <div><strong>goodsaem</strong> <em>좋은선생님</em></div></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Apps" class="dropdown-title"><span class="title">Apps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/apps/100-바코드-생성기.html" class="nav-link">100-바코드-생성기</a></li><li class="dropdown-item"><!----> <a href="/apps/101-폰트어썸-아이콘검색.html" class="nav-link">101-폰트어썸-아이콘검색</a></li><li class="dropdown-item"><!----> <a href="/apps/102-메모관리.html" class="nav-link">102-메모관리</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/goodsaem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Apps" class="dropdown-title"><span class="title">Apps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/apps/100-바코드-생성기.html" class="nav-link">100-바코드-생성기</a></li><li class="dropdown-item"><!----> <a href="/apps/101-폰트어썸-아이콘검색.html" class="nav-link">101-폰트어썸-아이콘검색</a></li><li class="dropdown-item"><!----> <a href="/apps/102-메모관리.html" class="nav-link">102-메모관리</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/goodsaem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/Hello.html" class="sidebar-link">인사말</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Apps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AWS 서버구축</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AWS + PHP 서버</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>로컬 서버 구축</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/local/101-로컬서버-구축.html" class="sidebar-link">1. 로컬 서버 구축</a></li><li><a href="/local/102-서버설정.html" class="sidebar-link">2. 서버설정</a></li><li><a href="/local/103-Nginx-설치.html" class="sidebar-link">3. Nginx 설치</a></li><li><a href="/local/104-MariaDB-설치.html" class="sidebar-link">4. MariaDB 설치</a></li><li><a href="/local/105-PHP-설치-설정.html" class="sidebar-link">5. PHP 7.4 설치 및 설정</a></li><li><a href="/local/106-Nginx-상세설정.html" class="sidebar-link">6. Nginx 상세 설정</a></li><li><a href="/local/107-무료도메인-발급.html" class="active sidebar-link">7. 무료 도메인 발급 및 SSL 인증서 발급받기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/local/107-무료도메인-발급.html#_1-무료-도메인-발급-받기" class="sidebar-link">1.무료 도메인 발급 받기</a></li><li class="sidebar-sub-header"><a href="/local/107-무료도메인-발급.html#_2-diffie-hellman-키-생성" class="sidebar-link">2. Diffie-Hellman 키 생성</a></li><li class="sidebar-sub-header"><a href="/local/107-무료도메인-발급.html#_3-let-s-encrypt-와-certbot-을-이용한-무료-인증서-발급" class="sidebar-link">3. Let's Encrypt 와 Certbot 을 이용한 무료 인증서 발급</a></li><li class="sidebar-sub-header"><a href="/local/107-무료도메인-발급.html#_4-ssl-점검" class="sidebar-link">4. SSL 점검</a></li></ul></li><li><a href="/local/108-ssl-테스트.html" class="sidebar-link">8. ssl 테스트</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Setup</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <footer class="siteFooter"><div class="container"><p class="siteFooterCopyright">
      Copyright © 2021 All Right <em>goodsaem</em></p> <p class="siteFooterContact">
      goodsaem@protonmail.com
      <a href="https://github.com/goodsaem" target="_blank">GitHub</a> .
    </p></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3ab2aa80.js" defer></script><script src="/assets/js/2.3b0ca9c5.js" defer></script><script src="/assets/js/12.31171b4c.js" defer></script>
  </body>
</html>
