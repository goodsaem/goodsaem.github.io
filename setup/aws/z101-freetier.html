<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>aws nginx php https ubuntu 18.0.4 maria db (lemp) all free | goodSaem</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="alternate" type="application/rss+xml" href="https://goodsaem.github.io/rss.xml" title="goodSaem RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://goodsaem.github.io/feed.atom" title="goodSaem Atom Feed">
    <link rel="alternate" type="application/json" href="https://goodsaem.github.io/feed.json" title="goodSaem JSON Feed">
    <meta name="description" content="aws nginx php https ubuntu 18 all free">
    <meta name="google-site-verification" content="TgI6W9yu3WmEvVxC8vfAGVxwUfd4J1RgQa_BoB8ZZvU">
    
    <link rel="preload" href="/assets/css/0.styles.69d474db.css" as="style"><link rel="preload" href="/assets/js/app.7c769ba4.js" as="script"><link rel="preload" href="/assets/js/2.9e82aae1.js" as="script"><link rel="preload" href="/assets/js/3.76c799d4.js" as="script"><link rel="prefetch" href="/assets/js/10.bad15ad2.js"><link rel="prefetch" href="/assets/js/11.41303fad.js"><link rel="prefetch" href="/assets/js/12.97111826.js"><link rel="prefetch" href="/assets/js/13.225944fb.js"><link rel="prefetch" href="/assets/js/14.3fcdd031.js"><link rel="prefetch" href="/assets/js/15.0e640bcc.js"><link rel="prefetch" href="/assets/js/16.aa15cf53.js"><link rel="prefetch" href="/assets/js/17.bbad5a21.js"><link rel="prefetch" href="/assets/js/18.828e9013.js"><link rel="prefetch" href="/assets/js/19.bef1304e.js"><link rel="prefetch" href="/assets/js/20.01eddc8f.js"><link rel="prefetch" href="/assets/js/21.84abea0b.js"><link rel="prefetch" href="/assets/js/22.48399af3.js"><link rel="prefetch" href="/assets/js/23.3879d0d9.js"><link rel="prefetch" href="/assets/js/24.579ea4ef.js"><link rel="prefetch" href="/assets/js/25.14eb022f.js"><link rel="prefetch" href="/assets/js/26.f08f0747.js"><link rel="prefetch" href="/assets/js/27.defc9b8f.js"><link rel="prefetch" href="/assets/js/28.1ec0f916.js"><link rel="prefetch" href="/assets/js/29.95ae932b.js"><link rel="prefetch" href="/assets/js/30.fb9a4f18.js"><link rel="prefetch" href="/assets/js/31.b084c98f.js"><link rel="prefetch" href="/assets/js/32.5c53ab4d.js"><link rel="prefetch" href="/assets/js/33.046c1af0.js"><link rel="prefetch" href="/assets/js/34.d29628fa.js"><link rel="prefetch" href="/assets/js/35.360f645c.js"><link rel="prefetch" href="/assets/js/36.1bf8451b.js"><link rel="prefetch" href="/assets/js/37.d52db04f.js"><link rel="prefetch" href="/assets/js/38.921ea180.js"><link rel="prefetch" href="/assets/js/39.caf9e45c.js"><link rel="prefetch" href="/assets/js/4.5b353746.js"><link rel="prefetch" href="/assets/js/40.7e3ee57d.js"><link rel="prefetch" href="/assets/js/41.fc4cacde.js"><link rel="prefetch" href="/assets/js/5.6b19b9cc.js"><link rel="prefetch" href="/assets/js/6.8afc6250.js"><link rel="prefetch" href="/assets/js/7.e365f783.js"><link rel="prefetch" href="/assets/js/8.863653e5.js"><link rel="prefetch" href="/assets/js/9.17c8332e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.69d474db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><main class="page"> <div class="theme-default-content content__default"><h1 id="setup-aws-nginx-php-https-ubuntu-18-all-free"><a href="#setup-aws-nginx-php-https-ubuntu-18-all-free" class="header-anchor">#</a> <i class="fa fa-baby"></i>  Setup : aws nginx php https ubuntu 18 all free</h1> <p>최근 php 의 slim framework 를 이용 해서 간단하게 rest api 서버를 구축하고 <a href="https://goodsaem.github.io" target="_blank" rel="noopener noreferrer">https://goodsaem.github.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 에서 rest api
서버에 json 형태의 문자를 보내서 데이터를 등록하고 조회하는 서비스를 만들었습니다. 로컬환경에서 테스트 할때는 문제가 없었지만 github 에 올리고 나서는 해당 예제가 동작하지
않았습니다. 그래서 크롬 개발자 도구를 열어 콘솔을 에러 로그를 보니 https 프로토콜을 사용하는 사이트에서 http로 데이터를 요청또는 보내게 되면 웹브라우저 보안 정책으로
차단시킨다고 합니다. 열심히 구글링해서 혼합 프로토콜을 사용할수 있는 방법을 찾아보았지만 해결방법을 찾을수 없었습니다.</p> <p><img src="/assets/img/z101-1.b5ff0bc4.jpg" alt="problem"></p> <p>생각해보면 당연한것 같아요 https로 보안성이 높은 웹사이트를 접속이 되어 있다가 보안이 확보되지 않은 http 프로토콜로 데이터를 보낼수 있다면 보안상 문제가 될수 있겠네요.<br>
그래서 https 를 제공해 주는 서버를 구축했습니다.</p> <h2 id="_1-condition"><a href="#_1-condition" class="header-anchor">#</a> 1. Condition</h2> <p>서버를 구축할때 아래의 조건에 맞게 구축되어야 된다는 원칙을 정하고 방법을 찾았습니다.</p> <ul><li>비용이 발생하면 안됩니다.</li> <li>완벽하게 https 를 지원해 주어야 됩니다.</li> <li>php 도 실행가능하고 spring 도 지원가능해야 됩니다.</li> <li>구축해야 되는 서버는 오로지 https://goodsaem.github.io 사이트에서 요청한 데이터만 응답해야 됩니다.</li> <li>db 도 사용할수 있어야 됩니다.</li></ul> <p>이런 조건을 맞추기 위해서는 <strong>aws 서버 구축</strong>이 정답이였습니다. 1년간 프리티어로 무료로 사용할수 있기에 회원가입을 하고 신용카드를
등록하여 프리티어 서버를 구축했습니다.</p> <h2 id="_2-architecture"><a href="#_2-architecture" class="header-anchor">#</a> 2. Architecture</h2> <ol><li>사용자가 브라우저를 통해서 <a href="https://goodsaem.github.io" target="_blank" rel="noopener noreferrer">https://goodsaem.github.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 를 접속합니다.</li> <li>데이터를 저장하거나 데이터를 db 조회가 필요한경우 <a href="https://goodsaem.duckdns.org" target="_blank" rel="noopener noreferrer">https://goodsaem.duckdns.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 로 rest api를 호출합니다.
<ul><li><a href="https://goodsaem.duckdns.org" target="_blank" rel="noopener noreferrer">https://goodsaem.duckdns.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> aws 프리티어 서버에 구축되어 있습니다.</li> <li>https://goodsaem.github.io 에서 오는 요청 및  localhost에서 실행한 요청에 대해서만 허용하고 나머지는 거부합니다.</li></ul></li> <li>nginx 웹서버는 https://goodsaem.github.io 에서 호출한 요청에 대해서만 응답하고 나머지 요청은 전부 거부하도록 설정합니다.</li> <li><a href="https://goodsaem.duckdns.org/php/" target="_blank" rel="noopener noreferrer">https://goodsaem.duckdns.org/php/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 아래의 하위 요청은 모두 php가 동작하도록 라우팅 하고
<a href="https://goodsaem.duckdns.org/spring/" target="_blank" rel="noopener noreferrer">https://goodsaem.duckdns.org/spring/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 으로 오는 요청은 spring boot가 응답하도록 설정합니다.</li> <li>db는 mariadb를 사용하며 php spring에서 데이터 crud가 필요한 경우 동작하도록 설계합니다.</li></ol> <p><img src="/assets/img/architecture.704e14bf.jpg" alt="problem"></p> <p>우선 서버 셋업이 완료되고 나서 ssl 수준이 얼마나 되는지 체크하는 사이트<a href="https://www.ssllabs.com/ssltest/analyze.html" target="_blank" rel="noopener noreferrer">https://www.ssllabs.com/ssltest/analyze.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>에 점검한 결과 입니다.
자세한 내용은 모르겠지만 A+ , A를 받았으니 잘 설정한것 같네요 ^^</p> <p><strong>https://goodsaem.github.io</strong></p> <p><img src="/assets/img/goodsaem.github.io.29cf7504.jpg" alt="goodsaem.github.io"></p> <p><strong>https://goodsaem.duckdns.org</strong></p> <p><img src="/assets/img/goodsaem.duckdns.org.ad2eb4f9.jpg" alt="goodsaem.duckdns.org"></p> <h2 id="_3-aws-account-createion"><a href="#_3-aws-account-createion" class="header-anchor">#</a> 3. Aws account createion</h2> <p>1년간 사용할 Aws 계정을 생성합니다.</p> <p><a href="https://aws.amazon.com/ko/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/ko/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 여기에 접속하여 우측상단의 AWS 계정생성 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-3.3e052966.jpg" alt="problem"></p> <p>이메일 주소 암호 계정 이름을 입력합니다.</p> <p><img src="/assets/img/z101-4.4fb1fe94.jpg" alt="problem"></p> <p>연락처 정보는 개인,전체이름 및 전화번호 주소 우편 번호를 입력합니다. 주소는 비용이 발생할경우 청구하는 주소가 되므로 정확히 기재해 주시고
영문으로 작성하셔야 됩니다. 영문주소 변환은 <a href="https://www.jusoen.com" target="_blank" rel="noopener noreferrer">https://www.jusoen.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 여기에서 가능합니다.</p> <p><img src="/assets/img/z101-5.25f39124.jpg" alt="problem"></p> <p>신용카드 정보와 만료날짜 및 신용카드에 적혀있는 카드 소유자 이름을 정확하게 입력하시고 청구지 주소를 선택합니다.</p> <p><img src="/assets/img/z101-6.8034d030.jpg" alt="problem"></p> <p>휴대폰 전화를 입력하여 문자로 확인코드를 받습니다. 보안검사 부분의 보안문자를 보안문자 입력하는 칸에 정확히 입력합니다.</p> <p><img src="/assets/img/z101-7.728dfe4e.jpg" alt="problem"></p> <p>휴대폰으로 온 문자를 확인하고 코드확인 란에 숫자를 입력하여 다음단계로 진행합니다.</p> <p><img src="/assets/img/z101-8.471f2804.jpg" alt="problem"></p> <p>마지막 단계로 기본지원 - 무료를 선택한후 가입을 완료합니다.</p> <p><img src="/assets/img/z101-9.a095abbd.jpg" alt="problem"></p> <h2 id="_4-create-free-tier-server"><a href="#_4-create-free-tier-server" class="header-anchor">#</a> 4. Create Free Tier Server</h2> <p>Free Tier 서버를 구축을 위해 가입하신 정보로 로그인한후 aws console 버튼을 클릭하신후 서비스 &gt; 모든 서비스 &gt; 컴퓨팅 &gt; EC2 서버를 선택합니다.</p> <p><img src="/assets/img/z101-10.dbd67102.jpg" alt="problem"></p> <p>EC2 좌측메뉴중 인스턴스를 클릭하고 다시 인스턴스 시작 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-11.256bb23b.jpg" alt="problem"></p> <p>프리티어 사용 가능이라고 된 서버가 무료 서버입니다. Ubuntu Server 18.04 LTS(HVM) SSD Volumn type을 선택 합니다.</p> <p><img src="/assets/img/z101-12.b8118b5b.jpg" alt="problem"></p> <p>다음 : 인스턴스 세부정보 구성 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-13.1a2f3f94.jpg" alt="problem"></p> <p>변경없이 다음 : 스토리지 추가를 클릭합니다.</p> <p><img src="/assets/img/z101-14.1c3f9ac7.jpg" alt="problem"></p> <p><strong>스토리지 추가는 30G까지 무료 입니다.</strong> 30 이라고 입력하고 다음 : 태그 추가 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-15.3f6c0aae.jpg" alt="problem"></p> <p>태그 추가 버튼을 클릭하여 키와 값에 식별할수 있는 이름을 입력합니다. 그리고 나서 다음 : 보안 그룹 구성 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-16.610bd76a.jpg" alt="problem"></p> <p>새 보안 그룹 생성을 선택하고 검토 및 시작 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-17.37cd7f7a.jpg" alt="problem"></p> <p>인스턴스 시작 검토 화면에서 선택한 내용들을 확인합니다. 그리고 나서 시작 하기 버튼을 클릭합니다.</p> <p><img src="/assets/img/z101-18.f5ccc95a.jpg" alt="problem"></p> <p>이렇게 시작하고 나면 키페이 생성 화면이 팝업이 되는데 새 키 페어 생성을 선택하고 키페어 이름을 입력하고 키 페이 다운로드 버튼을 클릭하여 로컬 pc에 저장합니다.
그리고 나서 인서턴스 시작 버튼을 클릭합니다. 여기까지 완료하셨으면 프리티어 서버가 정상 생성되었습니다.</p> <p><img src="/assets/img/z101-19.569d5efb.jpg" alt="problem"></p> <h2 id="_5-connecting-to-the-server"><a href="#_5-connecting-to-the-server" class="header-anchor">#</a> 5. Connecting to the server</h2> <p>먼저 서버에 접속 하는 방법 부터 알려드릴께요..</p> <ol><li>인스턴스 아이디 아래 부분의 인스턴스를 클릭합니다.</li> <li>연결 버튼을 클릭합니다.</li> <li>SSH 클라이언트 탭을 클릭합니다.</li> <li>SSH 클라이언트 아래의 텍스트를 복사합니다.
<ul><li><em>ssh -i &quot;goodsaem.pem&quot; ubuntu@ec2-13-209-42-88.ap-northeast-2.compute.amazonaws.com</em></li></ul></li></ol> <p><img src="/assets/img/20.331f4864.jpg" alt="problem"></p> <p>프리티어 서버생성할때 키를 생성했었습니다. 키 생성한 곳으로 이동하여 붙여 넣기 하고 엔터를 입력하면 아래와 같이 서버에 접속합니다.
제 pc 가 mac 이라 이런 방법으로 접속 했구요 putty 로 접속 가능합니다.</p> <h3 id="mac-connect"><a href="#mac-connect" class="header-anchor">#</a> mac connect</h3> <div class="language-shell line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-shell"><code>goodsaem@goodsaemui-iMac goodsaem % <span class="token function">ssh</span> -i <span class="token string">&quot;goodsaem.pem&quot;</span> ubuntu@ec2-13-209-42-88.ap-northeast-2.compute.amazonaws.com
Welcome to Ubuntu <span class="token number">18.04</span>.5 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">5.4</span>.0-1037-aws x86_64<span class="token punctuation">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Mar  <span class="token number">3</span> <span class="token number">22</span>:43:18 KST <span class="token number">2021</span>

  System load:  <span class="token number">0.0</span>               Processes:           <span class="token number">120</span>
  Usage of /:   <span class="token number">8.3</span>% of <span class="token number">29</span>.02GB   Users logged in:     <span class="token number">0</span>
  Memory usage: <span class="token number">39</span>%               IP address <span class="token keyword">for</span> eth0: <span class="token number">172.31</span>.47.167
  Swap usage:   <span class="token number">0</span>%

 * Introducing self-healing high availability clusters <span class="token keyword">in</span> MicroK8s.
   Simple, hardened, Kubernetes <span class="token keyword">for</span> production, from RaspberryPi to DC.

     https://microk8s.io/high-availability

 * Canonical Livepatch is available <span class="token keyword">for</span> installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

<span class="token number">18</span> packages can be updated.
<span class="token number">0</span> of these updates are security updates.
To see these additional updates run: <span class="token function">apt</span> list --upgradable


*** System restart required ***
Last login: Mon Mar  <span class="token number">1</span> <span class="token number">23</span>:55:26 <span class="token number">2021</span> from <span class="token number">1.247</span>.71.18
ubuntu@ip-172-31-47-167:~$ 

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="putty-connect-windows"><a href="#putty-connect-windows" class="header-anchor">#</a> putty connect(windows)</h3> <p>윈도우에서 putty 설치하는 방법 및 ec2 서버에 putty 를 통해서 접속하는 방법 입니다.</p> <p><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener noreferrer">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 설치파일을
다운로드 받고 설치를 진행합니다. default 로 다음 다음 하셔서 설치를 완료해 주세요..</p> <p><img src="/assets/img/21.22ed486e.jpg" alt="21"></p> <p>putty gen 을 실행 합니다.</p> <p><img src="/assets/img/22.bce1ccae.jpg" alt="21"></p> <p>load 버튼을 클릭합니다. 모든 파일을 <em>.</em> 선택하고 goodsaem.pem 파일을 불러 옵니다.</p> <p><img src="/assets/img/23.dfe7d974.jpg" alt="21"></p> <p>Save private key 버튼을 클릭합니다.</p> <p><img src="/assets/img/24.dc5f5111.jpg" alt="21"></p> <p>goodsaem.ppk 파일로 적당한 위치에 저장합니다.</p> <p><img src="/assets/img/25.fd2c6b71.jpg" alt="21"></p> <ul><li>putty 를 실행하고 위에서 ubuntu@ 뒤쪽에 있는 문자를 복사해서 호스트에 붙여 넣기 합니다. <strong>ec2-13-209-42-88.ap-northeast-2.compute.amazonaws.com</strong></li> <li>ssh 메뉴 아래 Auth를 클릭합니다.</li></ul> <p><img src="/assets/img/26.1c0b36d5.jpg" alt="21"></p> <p>Browse 버튼을 클릭하여 goodsaem.ppk 파일을 불러 옵니다.</p> <p><img src="/assets/img/27.f2e0b1e0.jpg" alt="img"></p> <p>파일을 불러 왔으면 Open 버튼을 클릭 합니다.</p> <p><img src="/assets/img/28.ce9f5fa8.jpg" alt="img"></p> <p>login 부분에 <strong>ubuntu</strong> 라고 입력하고 엔터를 클릭하면 아래와 같이 서버에 접속이 정상 완료됩니다.</p> <p><img src="/assets/img/28.ce9f5fa8.jpg" alt="img"></p> <h2 id="_6-initial-setup-of-ubuntu-18"><a href="#_6-initial-setup-of-ubuntu-18" class="header-anchor">#</a> 6. Initial setup of Ubuntu 18</h2> <p>구축한 ubuntu 18.0.4 서버에 초기 설정을 진행 하겠습니다. 필요없다고 생각하는 부분은 skip 하셔도 상관 없습니다.</p> <h3 id="version"><a href="#version" class="header-anchor">#</a> version</h3> <p>버전 정보를 확인 합니다. 설치 잘 되어 있네요 ^^</p> <div class="language-shell line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu <span class="token number">18.04</span>.5 LTS
Release:	<span class="token number">18.04</span>
Codename:	bionic
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>sudo 해서 root 하는 일을 많이 진행할 예정입니다. 그때 마다 패스워드를 입력하지 않기 위해 /etc/sudoers 파일을 수정합니다</p> <h3 id="nopasswd-setting"><a href="#nopasswd-setting" class="header-anchor">#</a> nopasswd setting</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">sudo</span> <span class="token function">vi</span> /etc/sudoers
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>%sudo ALL=(ALL:ALL) ALL 이라고 된부분을 아래와 같이 %sudo ALL=(ALL:ALL) NOPASSWD:ALL 로 수정 합니다.</p> <div class="language-shell line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-shell"><code><span class="token comment">#</span>
<span class="token comment"># This file MUST be edited with the 'visudo' command as root.</span>
<span class="token comment">#</span>
<span class="token comment"># Please consider adding local content in /etc/sudoers.d/ instead of</span>
<span class="token comment"># directly modifying this file.</span>
<span class="token comment">#</span>
<span class="token comment"># See the man page for details on how to write a sudoers file.</span>
<span class="token comment">#</span>
Defaults        env_reset
Defaults        mail_badpass
Defaults        <span class="token assign-left variable">secure_path</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin&quot;</span>

<span class="token comment"># Host alias specification</span>

<span class="token comment"># User alias specification</span>

<span class="token comment"># Cmnd alias specification</span>

<span class="token comment"># User privilege specification</span>
root    <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL:ALL<span class="token punctuation">)</span> ALL

<span class="token comment"># Members of the admin group may gain root privileges</span>
%admin <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL

<span class="token comment"># Allow members of group sudo to execute any command</span>
%sudo   <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL:ALL<span class="token punctuation">)</span> NOPASSWD:ALL

<span class="token comment"># See sudoers(5) for more information on &quot;#include&quot; directives:</span>

<span class="token comment">#includedir /etc/sudoers.d</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="latest-package"><a href="#latest-package" class="header-anchor">#</a> Latest package</h3> <p>최신 패키지로 변경하기 위해 아래와 같이 update upgrade 를 진행합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">sudo</span> <span class="token function">apt</span> update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">sudo</span> <span class="token function">apt</span> upgrade -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="timezone-change"><a href="#timezone-change" class="header-anchor">#</a> Timezone Change</h3> <p>기본 설치하고 나면 timezone이 utc로 설정 되어 있습니다. 한국 리전에서 생성했으면 timezone을 서울로 해주면 좋을텐데 ㅎㅎ 타임존을 서울로 변경해 줍니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ udo timedatectl set-timezone <span class="token string">'Asia/Seoul'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>date 명령을 입력하여 정상적으로 변경되었는지 확인 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">date</span>
Wed Mar  <span class="token number">3</span> <span class="token number">23</span>:52:20 KST <span class="token number">2021</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="hostname-change"><a href="#hostname-change" class="header-anchor">#</a> hostname change</h3> <p>아직 호스트 이름을 바꾸지 않아 아래와 <em>ip-172-31-47-167</em> 나옵니다 아래 명령어를 입력하여 호스트 이름을 goodsaem으로 변경합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">sudo</span> hostnamectl set-hostname goodsaem
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>정상적으로 변경되었는지 확인 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">cat</span> /etc/hostname
goodsaem
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>서버를 재시작 하면 호스트 이름이 변경되므로 변경되지 않도록 설정을 수정합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token function">sudo</span> <span class="token function">vi</span> /etc/cloud/cloud.cfg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>아래 내용중 preserve_hostname: false 되어 있는 부분을 true로 변경합니다.</p> <div class="language-shell line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-shell"><code><span class="token comment"># The top level settings are used as module</span>
<span class="token comment"># and system configuration.</span>

<span class="token comment"># A set of users which may be applied and/or used by various modules</span>
<span class="token comment"># when a 'default' entry is found it will reference the 'default_user'</span>
<span class="token comment"># from the distro configuration specified below</span>
users:
- default

<span class="token comment"># If this is set, 'root' will not be able to ssh in and they</span>
<span class="token comment"># will get a message to login instead as the default $user</span>
disable_root: <span class="token boolean">true</span>

<span class="token comment"># This will cause the set+update hostname module to not operate (if true)</span>
preserve_hostname: <span class="token boolean">true</span>

<span class="token comment"># Example datasource config</span>
<span class="token comment"># datasource:</span>
<span class="token comment">#    Ec2:</span>
<span class="token comment">#      metadata_urls: [ 'blah.com' ]</span>
<span class="token comment">#      timeout: 5 # (defaults to 50 seconds)</span>
<span class="token comment">#      max_wait: 10 # (defaults to 120 seconds)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>다시 로그아웃 하고 로그인 했을때 hostname 이 변경되었는지 확인 합니다. goodsaem으로 정상 변경되었습니다.</p> <div class="language-shell line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-shell"><code>ubuntu@ip-172-31-47-167:~$ <span class="token builtin class-name">logout</span>
Connection to ec2-13-209-42-88.ap-northeast-2.compute.amazonaws.com closed.
goodsaem@goodsaemui-iMac goodsaem % <span class="token function">ssh</span> -i <span class="token string">&quot;goodsaem.pem&quot;</span> ubuntu@ec2-13-209-42-88.ap-northeast-2.compute.amazonaws.com
Welcome to Ubuntu <span class="token number">18.04</span>.5 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">5.4</span>.0-1037-aws x86_64<span class="token punctuation">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Thu Mar  <span class="token number">4</span> 00:00:55 KST <span class="token number">2021</span>

  System load:  <span class="token number">0.0</span>               Processes:           <span class="token number">121</span>
  Usage of /:   <span class="token number">8.3</span>% of <span class="token number">29</span>.02GB   Users logged in:     <span class="token number">1</span>
  Memory usage: <span class="token number">39</span>%               IP address <span class="token keyword">for</span> eth0: <span class="token number">172.31</span>.47.167
  Swap usage:   <span class="token number">0</span>%

 * Introducing self-healing high availability clusters <span class="token keyword">in</span> MicroK8s.
   Simple, hardened, Kubernetes <span class="token keyword">for</span> production, from RaspberryPi to DC.

     https://microk8s.io/high-availability

 * Canonical Livepatch is available <span class="token keyword">for</span> installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

<span class="token number">18</span> packages can be updated.
<span class="token number">0</span> of these updates are security updates.
To see these additional updates run: <span class="token function">apt</span> list --upgradable

New release <span class="token string">'20.04.2 LTS'</span> available.
Run <span class="token string">'do-release-upgrade'</span> to upgrade to it.


*** System restart required ***
Last login: Wed Mar  <span class="token number">3</span> <span class="token number">23</span>:13:55 <span class="token number">2021</span> from <span class="token number">1.247</span>.71.18
ubuntu@goodsaem:~$
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="etc-hosts-change"><a href="#etc-hosts-change" class="header-anchor">#</a> /etc/hosts change</h3> <p>아이피와 호스트 정보를 입력해 주세요 전 127.0.0.1 과 aws 부여해준 공인 아이피(이아이피는 서버를 재시작 하면 다른 아이피로 변경됩니다.)를 입력했습니다.
전 가급적이면 서버를 재시작 하지 않을 계획이므로 그대로 사용하겠습니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">vi</span> /etc/hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1 localhost
<span class="token number">127.0</span>.0.1 goodsaem
<span class="token number">13.209</span>.42.88 goodsaem.ml

<span class="token comment"># The following lines are desirable for IPv6 capable hosts</span>
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_7-ubuntu-18-0-4-lemp-linux-nginx-php-mariadb-setup"><a href="#_7-ubuntu-18-0-4-lemp-linux-nginx-php-mariadb-setup" class="header-anchor">#</a> 7. Ubuntu 18.0.4 - LEMP(Linux + Nginx + PHP + MariaDB) Setup</h2> <p>한참 리눅스 설치할때는 apm 조합이였습니다. (apache php mysql) 정말 오랜만에 셋팅하는데 세상이 바꼈네요 비동기로 동작하여 apache 보다 훨씬 빠르다고
알려진 Nginx 가 웹서버 역할을 담당하고 mysql 상용화 되어 그 자리를 maria db가 대신 합니다.</p> <h3 id="nginx-install"><a href="#nginx-install" class="header-anchor">#</a> Nginx install</h3> <p>Nginx는 MainLine 버전과 stable 버전 2가지가 존재 합니다. 메인라이는 새로운 기능 및 업데이트 및 버그 패치가 동시에 진행되고 stable 은 메인라인에서
버그패치만 진행하는 버전입니다. 메이저 버전을 올리고 싶지 않고 사용하고 싶다면 stable 버전이 좋겠지만 전 최신 기능과 update 및 버그 픽스가 동시에
이루어지는 mainline으로 설치를 진행하겠습니다.</p> <p><img src="/assets/img/30.4b393630.jpg" alt="img"></p> <h4 id="nginx-dependency-package-install"><a href="#nginx-dependency-package-install" class="header-anchor">#</a> nginx dependency package install</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">curl</span> gnupg2 ca-certificates lsb-release -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="nginx-mainline-package-add"><a href="#nginx-mainline-package-add" class="header-anchor">#</a> nginx mainline package add</h4> <p>메인라인 패키지 리스트를 추가해 줍니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;deb http://nginx.org/packages/mainline/ubuntu <span class="token variable"><span class="token variable">`</span>lsb_release -cs<span class="token variable">`</span></span> nginx&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/nginx.list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>패키지를 업데이트 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt</span> update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>nginx 를 설치합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>설치된 버전을 확인 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ nginx -V
nginx version: nginx/1.19.7
built by gcc <span class="token number">7.5</span>.0 <span class="token punctuation">(</span>Ubuntu <span class="token number">7.5</span>.0-3ubuntu1~18.04<span class="token punctuation">)</span>
built with OpenSSL <span class="token number">1.1</span>.1  <span class="token number">11</span> Sep <span class="token number">2018</span> <span class="token punctuation">(</span>running with OpenSSL <span class="token number">1.1</span>.1j  <span class="token number">16</span> Feb <span class="token number">2021</span><span class="token punctuation">)</span>
TLS SNI support enabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="mariadb-install"><a href="#mariadb-install" class="header-anchor">#</a> MariaDB install</h3> <p>mariadb 설치를 진행하겠습니다.</p> <p>우선 repository 부터 아래와 같이 설정합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> software-properties-common
ubuntu@goodsaem:~$ <span class="token function">sudo</span> apt-key adv --fetch-keys <span class="token string">'https://mariadb.org/mariadb_release_signing_key.asc'</span>
ubuntu@goodsaem:~$ <span class="token function">sudo</span> add-apt-repository <span class="token string">'deb [arch=amd64,arm64,ppc64el] https://mirror.yongbok.net/mariadb/repo/10.5/ubuntu bionic main'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>패키지를 업데이트한후 mariadb 설치를 진행합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt</span> update
ubuntu@goodsaem:~$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> mariadb-server -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="mariadb-seucre-install"><a href="#mariadb-seucre-install" class="header-anchor">#</a> mariadb seucre install</h4> <p>마리아 db를 설치하고 나면 디비 보안 관련 설정을 진행해야 합니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> mysql_secure_installation
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>중간에 불필요한 부분은 삭제 했습니다.</p> <ul><li><strong>1 라인</strong> root 유저가 사용할 패스워드를 입력합니다.</li> <li><strong>4 라인</strong> unix socket 인증방식 사용여부는 n 으로 지정해 주세요(root 쉘인증이 기본 사용됩니다.)</li> <li><strong>8,9,10 라인</strong> root passwor를 변경합니다.</li> <li><strong>15 라인</strong> 익명 사용자를 삭제 합니다.</li> <li><strong>17 라인</strong> root의 원격접속을 막습니다. root 는 항상 로컬에서만 접속 가능합니다.</li> <li><strong>19 라인</strong> test 데이터 베이스를 삭제 합니다.</li> <li><strong>25 라인</strong> 권한에 대한 리로드를 진행합니다. y를 입력해주세요</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Enter current password <span class="token keyword">for</span> root <span class="token punctuation">(</span>enter <span class="token keyword">for</span> none<span class="token punctuation">)</span>:
OK, successfully used password, moving on…
<span class="token punctuation">..</span>.
You already have your root account protected, so you can safely answer <span class="token string">'n'</span><span class="token builtin class-name">.</span>
<span class="token punctuation">..</span>.
Switch to unix_socket authentication <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> n
<span class="token punctuation">..</span>.
Change the root password? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> y
New password:
Re-enter new password:
Password updated successfully<span class="token operator">!</span>
Reloading privilege tables<span class="token punctuation">..</span>
… Success<span class="token operator">!</span>
<span class="token punctuation">..</span>.
Remove anonymous users? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> y
<span class="token punctuation">..</span>.
Disallow root login remotely? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> y
<span class="token punctuation">..</span>.
Remove <span class="token builtin class-name">test</span> database and access to it? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> y
- Dropping <span class="token builtin class-name">test</span> database…
  … Success<span class="token operator">!</span>
- Removing privileges on <span class="token builtin class-name">test</span> database…
  … Success<span class="token operator">!</span>
<span class="token punctuation">..</span>.  
Reload privilege tables now? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> y
… Success<span class="token operator">!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="mariadb-connect"><a href="#mariadb-connect" class="header-anchor">#</a> mariadb connect</h4> <p>아래 명령어를 입력하여 mariadb 에 접속합니다. 성공적으로 접속되었습니다.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ubuntu@goodsaem:~$ <span class="token function">sudo</span> mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Welcome to the MariaDB monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MariaDB connection <span class="token function">id</span> is <span class="token number">156</span>
Server version: <span class="token number">10.5</span>.9-MariaDB-1:10.5.9+maria~bionic-log mariadb.org binary distribution

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2018</span>, Oracle, MariaDB Corporation Ab and others.

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'<span class="token entity" title="\c">\c</span>'</span> to <span class="token function">clear</span> the current input statement.

MariaDB <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>생각했던것보다 글이 길어지고 있습니다. 그래도 한번 정리해 보겠습니다. 오늘은 이만... 다음시간에 이어서 정리하겠습니다.
글을 한번에 다 적을수는 없네요..</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/setup/vue/z101-setup.html" class="prev">Vue.js 개발환경 setup</a></span> <!----></p></div>  <div><div id="comment" class="comment"></div></div></main> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><figure><img src="https://avatars.githubusercontent.com/u/72680592?s=400&amp;u=745704d80b906fded3d9399a38120d35e6944318&amp;v=4" alt="goodSaem"></figure> <div><strong>goodsaem</strong> <em>좋은선생님</em></div></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/goodsaem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/goodsaem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repository
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>php</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>setup</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>H2 DB</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Vue.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>AWS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/setup/aws/z101-freetier.html" aria-current="page" class="active sidebar-link">aws nginx php https ubuntu 18.0.4 maria db (lemp) all free</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_1-condition" class="sidebar-link">1. Condition</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_2-architecture" class="sidebar-link">2. Architecture</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_3-aws-account-createion" class="sidebar-link">3. Aws account createion</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_4-create-free-tier-server" class="sidebar-link">4. Create Free Tier Server</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_5-connecting-to-the-server" class="sidebar-link">5. Connecting to the server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#mac-connect" class="sidebar-link">mac connect</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#putty-connect-windows" class="sidebar-link">putty connect(windows)</a></li></ul></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_6-initial-setup-of-ubuntu-18" class="sidebar-link">6. Initial setup of Ubuntu 18</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#version" class="sidebar-link">version</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#nopasswd-setting" class="sidebar-link">nopasswd setting</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#latest-package" class="sidebar-link">Latest package</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#timezone-change" class="sidebar-link">Timezone Change</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#hostname-change" class="sidebar-link">hostname change</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#etc-hosts-change" class="sidebar-link">/etc/hosts change</a></li></ul></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#_7-ubuntu-18-0-4-lemp-linux-nginx-php-mariadb-setup" class="sidebar-link">7. Ubuntu 18.0.4 - LEMP(Linux + Nginx + PHP + MariaDB) Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#nginx-install" class="sidebar-link">Nginx install</a></li><li class="sidebar-sub-header"><a href="/setup/aws/z101-freetier.html#mariadb-install" class="sidebar-link">MariaDB install</a></li></ul></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <footer class="siteFooter"><div class="container"><p class="siteFooterCopyright">
      Copyright © 2021 All Right <em>goodsaem</em></p> <p class="siteFooterContact">
      goodsaem@protonmail.com
      <a href="https://github.com/goodsaem" target="_blank">GitHub</a> .
    </p></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7c769ba4.js" defer></script><script src="/assets/js/2.9e82aae1.js" defer></script><script src="/assets/js/3.76c799d4.js" defer></script>
  </body>
</html>
